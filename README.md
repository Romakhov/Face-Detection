# Обнаружение лиц на изображении #
Обнаружение лиц – технология поиска человеческих лиц на фотографии или видеоизображениях с помощью алгоритмов компьютерного зрения. Система определяет границы и признаки лица и выделяет зону на изображении. Если на фотографии несколько лиц, то система выделит каждое лицо. Обнаружение лиц является первым этапом в построении систем распознавания лиц. 
## Каскады Хаара методом Виолы-Джонс ##
В данном разделе рассмотрены каскадные классификаторы с применением алгоритма Виолы-Джонса. Идея каскадирования заключается в многоступенчатом обучении цепочки классификаторов. Каскадные классификаторы обучаются на изображениях положительных и отрицательных образцов и после обучения его можно применить на поиске лица на изображении.

Алгоритм был разработан в 2001 году Полом Виолой и Майклом Джонсом, и он основан на 4 основных концепциях:
Выделение на изображении признаков Хаара;
Интегральное представление изображений для определения суммарной яркости;
Применение бустинга для обучения классификатора;
Каскадный классификатор.

На вход поступает изображение, содержащее одно или нескольких лиц. Алгоритм должен выделить области, на которых присутствует лицо.
### Признаки Хаара ###
Признаки Хаара - это основные характерные признаки исследуемого объекта на изображении. В методе Виолы-Джонс признаками являются прямоугольники, называемые примитивами Хаара. Они представляют собой прямоугольники с белой область и черной областью, полученными разностью сумм пикселей двух смежных областей внутри прямоугольника. 

Признак измеряет разницу в интенсивности между двумя признаками. Значение объекта просто вычисляется путем суммирования пикселей в темной области и вычитания пикселей в белой области. Для их вычисления используется понятие интегрального изображения, которое будет рассмотрено далее.
### Интегральное представление изображений ###
Интегральное представление изображений применяется для расчета суммарной яркости произвольного прямоугольника на фотографии. Это матрица, размерность которой совпадает с размерностью исходного изображения. 
### Обучение классификатора ###
Adaboost используется для выбора небольшого набора признаков и обучения классификатора. Слабый алгоритм обучения, на основе которого мы строим стимулирующую модель, предназначен для выбора функции одного прямоугольника, которая разделяет лучшие отрицательные и положительные примеры. Алгоритм Adaboost обучается на основе цепочки классификаторов, которые обучаются на основе предыдущих. 

### Классификатор каскадов ###
Классификатор каскадов строится на основе дерева принятия решений: на каждом положении сканирующего окна выбирается наиболее подходящий порог для каждого признака. Классификатор отклоняет регионы, которые не являются образами. Данный вид каскадной модели хорошо подходит для обработки изображений, на которых общее количество детектируемых образов мало. В итоге алгоритм обнаруживает лицо на изображении и выделяет область обнаружения.

## Гистограмма направленных градиентов (HOG) ##
Идея метода обнаружения лица HOG-дескриптором заключается в преобразовании изображения в векторное представление и последующей классификации изображения алгоритмом классификации машинного обучения. Метод разработан в 2005 году. 
Основные этапы в алгоритме:
Нормализация данных.
Вычисление градиента. Используется фильтр для вычисления градиента с использованием определенной маски.
Группировка направлений. На следующем шаге вычисляются гистограммы ячеек. Каждый пиксел в ячейке участвует во взвешенном голосовании для каналов гистограммы направлений, основанном на значении градиентов. 
Блоки дескрипторов. Изображение делится на блоки размером 16 на 16, в каждом блоке рассчитывается единый градиент.
Нормализация блоков.
Определение лица с помощью SVM или других алгоритмов.

### Нормализация данных ###
Для эффективного поиска на изображении человеческого лица необходимо нормализовать изображение, которое поступило на вход. Все изображения должны быть одинакового размера. В программной реализации применялись изображения приводились к формату 100x200 пикселей. 

### Вычисление градиентов ###
Для вычисления градиентов используются вертикальный и горизонтальный фильтр, состоящие из 3-х ячеек. Таким образом, фильтры проходят по всему изображению и преобразуют его.

### Группировка направлений ###
Для группировки направлений изображение делится на 64 блока. Чтобы оценить направление градиента внутри области, строится гистограмма среди 64 значений направлений градиента и их величины внутри каждой области. Категории гистограммы соответствуют углам градиента от 0 до 180 °. Всего 9 категорий: 0 °, 20 °, 40 °… 160 °.

### Нормализация блока ###
Блок 16x16 может быть применен, чтобы нормализовать изображение и сделать его инвариантным, например, к освещению. Алгоритм HOG обнаружил все 4 лица в отличие от каскадов Хаара.

## Сверточная нейронная сеть для обнаружения лица ##
Последний метод обнаружения лица на изображении - это сверточная нейронная сеть. Суть метода заключается в последовательном выполнении операции свертки посредством “движения” матрицы весов по изображению. После каждого сдвиг матрицы формируются активационный сигнал для следующего слоя. 
Сверточная нейронная сеть состоит из входного изображения, скрытых сверточных слоев, полученных путем прохождения матрицы весов по изображению и выходного значения. В случае задачи обнаружения лиц выходное значение будет содержать либо 0, либо 1.

